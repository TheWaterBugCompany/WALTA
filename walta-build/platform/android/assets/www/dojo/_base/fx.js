//>>built
define("dojo/_base/fx","./kernel,./config,./lang,../Evented,./Color,./connect,./sniff,../dom,../dom-style".split(","),function(n,t,g,u,i,k,w,p,o){var j=g.mixin,e={},q=e._Line=function(a,c){this.start=a;this.end=c};q.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};var h=e.Animation=function(a){j(this,a);if(g.isArray(this.curve))this.curve=new q(this.curve[0],this.curve[1])};h.prototype=new u;g.extend(h,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=
this._percent,c=this.easing;return c?c(a):a},_fire:function(a,c){var f=c||[];if(this[a])if(t.debugAtAllCosts)this[a].apply(this,f);else try{this[a].apply(this,f)}catch(d){console.error("exception in animation handler for:",a),console.error(d)}return this},play:function(a,c){this._delayTimer&&this._clearTimer();if(c)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);var f=a||this.delay,d=g.hitch(this,
"_play",c);if(0<f)return this._delayTimer=setTimeout(d,f),this;d();return this},_play:function(){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;var a=this.curve.getValue(this._getStep());if(!this._percent){if(!this._startRepeatCount)this._startRepeatCount=this.repeat;this._fire("onBegin",[a])}this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&
this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,c){this._stopTimer();this._active=this._paused=!0;this._percent=a;c&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();if(a)this._percent=1;this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},status:function(){return this._active?
this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=(new Date).valueOf(),a=0===this.duration?1:(a-this._startTime)/this.duration;1<=a&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);if(1>this._percent)this._startTimer();else{this._active=!1;if(0<this.repeat)this.repeat--,this.play(null,!0);else if(-1==this.repeat)this.play(null,!0);else if(this._startRepeatCount)this.repeat=this._startRepeatCount,this._startRepeatCount=
0;this._percent=0;this._fire("onEnd",[this.node]);!this.repeat&&this._stopTimer()}}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var l=0,m=null,r={run:function(){}};g.extend(h,{_startTimer:function(){if(!this._timer)this._timer=k.connect(r,"run",this,"_cycle"),l++;m||(m=setInterval(g.hitch(r,"run"),this.rate))},_stopTimer:function(){if(this._timer)k.disconnect(this._timer),this._timer=null,l--;0>=l&&(clearInterval(m),m=null,l=0)}});var v=function(){};
e._fade=function(a){a.node=p.byId(a.node);var c=j({properties:{}},a),a=c.properties.opacity={};a.start=!("start"in c)?function(){return+o.get(c.node,"opacity")||0}:c.start;a.end=c.end;a=e.animateProperty(c);k.connect(a,"beforeBegin",g.partial(v,c.node));return a};e.fadeIn=function(a){return e._fade(j({end:1},a))};e.fadeOut=function(a){return e._fade(j({end:0},a))};e._defaultEasing=function(a){return 0.5+Math.sin((a+1.5)*Math.PI)/2};var s=function(a){this._properties=a;for(var c in a){var f=a[c];if(f.start instanceof
i)f.tempColor=new i}};s.prototype.getValue=function(a){var c={},f;for(f in this._properties){var d=this._properties[f],b=d.start;b instanceof i?c[f]=i.blendColors(b,d.end,a,d.tempColor).toCss():g.isArray(b)||(c[f]=(d.end-b)*a+b+("opacity"!=f?d.units||"px":0))}return c};e.animateProperty=function(a){var c=a.node=p.byId(a.node);if(!a.easing)a.easing=n._defaultEasing;a=new h(a);k.connect(a,"beforeBegin",a,function(){var a={},d;for(d in this.properties){if("width"==d||"height"==d)this.node.display="block";
var b=this.properties[d];g.isFunction(b)&&(b=b(c));b=a[d]=j({},g.isObject(b)?b:{end:b});if(g.isFunction(b.start))b.start=b.start(c);if(g.isFunction(b.end))b.end=b.end(c);var e=0<=d.toLowerCase().indexOf("color"),h=function(a,c){var b={height:a.offsetHeight,width:a.offsetWidth}[c];if(void 0!==b)return b;b=o.get(a,c);return"opacity"==c?+b:e?b:parseFloat(b)};if("end"in b){if(!("start"in b))b.start=h(c,d)}else b.end=h(c,d);e?(b.start=new i(b.start),b.end=new i(b.end)):b.start="opacity"==d?+b.start:parseFloat(b.start)}this.curve=
new s(a)});k.connect(a,"onAnimate",g.hitch(o,"set",a.node));return a};e.anim=function(a,c,f,d,b,g){return e.animateProperty({node:a,duration:f||h.prototype.duration,properties:c,easing:d,onEnd:b}).play(g||0)};j(n,e);n._Animation=h;return e});