//>>built
define("dijit/Editor","require,dojo/_base/array,dojo/_base/declare,dojo/_base/Deferred,dojo/i18n,dojo/dom-attr,dojo/dom-class,dojo/dom-geometry,dojo/dom-style,dojo/_base/event,dojo/keys,dojo/_base/lang,dojo/sniff,dojo/string,dojo/topic,dojo/_base/window,./_base/focus,./_Container,./Toolbar,./ToolbarSeparator,./layout/_LayoutWidget,./form/ToggleButton,./_editor/_Plugin,./_editor/plugins/EnterKeyHandling,./_editor/html,./_editor/range,./_editor/RichText,./main,dojo/i18n!./_editor/nls/commands".split(","),
function(t,j,k,u,v,w,m,n,l,o,c,f,p,x,y,q,r,G,z,A,B,C,h,D,s,g,E,F){function d(a){return new h({command:a.name})}function i(a){return new h({buttonClass:C,command:a.name})}k=k("dijit.Editor",E,{plugins:null,extraPlugins:null,constructor:function(){if(!f.isArray(this.plugins))this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",
D];this._plugins=[];this._editInterval=1E3*this.editActionInterval},postMixInProperties:function(){this.setValueDeferred=new u;this.inherited(arguments)},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(f.isArray(this.extraPlugins))this.plugins=this.plugins.concat(this.extraPlugins);this.inherited(arguments);this.commands=v.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar)this.toolbar=new z({ownerDocument:this.ownerDocument,
dir:this.dir,lang:this.lang}),this.header.appendChild(this.toolbar.domNode);j.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);m.add(this.iframe.parentNode,"dijitEditorIFrameContainer");m.add(this.iframe,"dijitEditorIFrame");w.set(this.iframe,"allowTransparency",!0);l.set(this.domNode,"KhtmlUserSelect","none");this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){j.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();
delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var e=f.isString(a)?{name:a}:f.isFunction(a)?{ctor:a}:a;if(!e.setEditor){var c={args:e,plugin:null,editor:this};if(e.name)h.registry[e.name]?c.plugin=h.registry[e.name](e):y.publish(F._scopeName+".Editor.getPlugin",c);if(!c.plugin)try{var d=e.ctor||f.getObject(e.name)||t(e.name);if(d)c.plugin=new d(e)}catch(g){throw Error(this.id+": cannot find plugin ["+e.name+"]");}if(!c.plugin)throw Error(this.id+": cannot find plugin ["+e.name+
"]");a=c.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);f.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&B.prototype.resize.apply(this,arguments)},layout:function(){this.editingArea.style.height=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+n.getPadBorderExtents(this.iframe.parentNode).h+n.getMarginExtents(this.iframe.parentNode).h)+"px";if(this.iframe)this.iframe.style.height="100%";this._layoutMode=!0},_onIEMouseDown:function(a){var b,
e=this.document.body,c=e.clientWidth,d=e.clientHeight,f=e.clientLeft,g=e.offsetWidth,h=e.offsetHeight,i=e.offsetLeft;/^rtl$/i.test(e.dir||"")?c<g&&a.x>c&&a.x<g&&(b=!0):a.x<f&&a.x>i&&(b=!0);b||d<h&&a.y>d&&a.y<h&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&
this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){if(!this._inEditing)this._inEditing=!0,this._beginEditing(a);if(0<this.editActionInterval)this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval)},_steps:[],_undoedSteps:[],execCommand:function(a){if(this.customUndo&&("undo"==a||"redo"==a))return this[a]();this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();
return b},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var b;try{if(b=this.document.execCommand(a,!1,null),!b)throw{code:1011};}catch(e){if(1011==e.code||9==e.code&&p("opera"))b=x.substitute,alert(b(this.commands.systemShortcut,[this.commands[a],b(this.commands[p("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])]));b=!1}return b},
queryCommandEnabled:function(a){return this.customUndo&&("undo"==a||"redo"==a)?"undo"==a?1<this._steps.length:0<this._undoedSteps.length:this.inherited(arguments)},_moveToBookmark:function(a){var a=a.mark,b,e,c,d;if(a&&(d=g.getSelection(this.window))&&d.removeAllRanges)d.removeAllRanges(),b=g.create(this.window),e=g.getNode(a.startContainer,this.editNode),c=g.getNode(a.endContainer,this.editNode),e&&c&&(b.setStart(e,a.startOffset),b.setEnd(c,a.endOffset),d.addRange(b))},_changeToStep:function(a,b){this.setValue(b.text);
var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();
b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){if(this._editTimer)this._editTimer=this._editTimer.remove();if(this._inEditing)this._endEditing(a),this._inEditing=!1},_getBookmark:function(){var a=q.withGlobal(this.window,r.getBookmark),b=[];if(a&&a.mark)try{if(a.mark&&a.mark.startContainer)b=g.getIndex(a.mark.startContainer,this.editNode).o,
a.mark={startContainer:b,startOffset:a.mark.startOffset,endContainer:a.mark.endContainer===a.mark.startContainer?b:g.getIndex(a.mark.endContainer,this.editNode).o,endOffset:a.mark.endOffset}}catch(c){a.mark=null}return a},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:s.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=s.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){!this.iframe&&
a.keyCode==c.TAB&&!this.tabIndent&&this._saveSelection();if(this.customUndo){var b=a.keyCode;if(a.ctrlKey&&!a.altKey){if(90==b||122==b){o.stop(a);this.undo();return}if(89==b||121==b){o.stop(a);this.redo();return}}this.inherited(arguments);switch(b){case c.ENTER:case c.BACKSPACE:case c.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&
!a.altKey&&!a.metaKey&&(a.keyCode<c.F1||a.keyCode>c.F15)){this.beginEditing();break}case c.ALT:this.endEditing();break;case c.UP_ARROW:case c.DOWN_ARROW:case c.LEFT_ARROW:case c.RIGHT_ARROW:case c.HOME:case c.END:case c.PAGE_UP:case c.PAGE_DOWN:this.endEditing(!0);case c.CTRL:case c.SHIFT:case c.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(a){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,q.withGlobal(this.window,"isCollapsed",r)&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="&#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(f.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&
a?j.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&j.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&l.set(this.document.body,"color",l.get(this.iframe,"color"))}catch(a){}}});f.mixin(h.registry,{undo:d,redo:d,cut:d,copy:d,paste:d,insertOrderedList:d,insertUnorderedList:d,indent:d,outdent:d,justifyCenter:d,justifyFull:d,justifyLeft:d,justifyRight:d,
"delete":d,selectAll:d,removeFormat:d,unlink:d,insertHorizontalRule:d,bold:i,italic:i,underline:i,strikethrough:i,subscript:i,superscript:i,"|":function(){return new h({setEditor:function(a){this.editor=a;this.button=new A({ownerDocument:a.ownerDocument})}})}});return k});