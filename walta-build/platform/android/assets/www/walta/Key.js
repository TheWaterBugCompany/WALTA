//>>built
define("walta/Key","dojo/_base/declare,dojo/request/xhr,dojo/_base/lang,walta/XmlDocument,walta/KeyNode,walta/Taxon".split(","),function(d,h,e,f,c,g){return d(null,{url:null,name:null,currentDecision:null,_xml:null,_startNode:null,load:function(){this._xml=new f({url:this.url+"/key.xml",namespaceMap:{tax:"http://thewaterbug.net/taxonomy"}});return this._xml.load().then(e.hitch(this,function(){this.name=this._xml.getString(null,"/tax:key/@name");this._startNode=this.currentDecision=new c(this.url,
this._xml,this._xml.getNode(null,"/tax:key/tax:keyNode"))}))},choose:function(a){return this.currentDecision=this.currentDecision.questions[a].outcome()},back:function(){var a=this.currentDecision.back();if(null!=a)this.currentDecision=a;return a},reset:function(){this.currentDecision=this._startNode},lookupNode:function(a){var a=this._xml.getNode(null,"/tax:key//tax:taxon[@id='"+a+"'] | /tax:key//tax:keyNode[@id='"+a+"']"),b=null;if("taxon"===a.tagName)b=this._xml.getNode(a,".."),b=new g(c,this.url,
this._xml,b,a);else if("keyNode"===a.tagName)b=new c(this.url,this._xml,a);else throw"Error: not a taxon or keyNode element!";return this.currentDecision=b},constructor:function(a){d.safeMixin(this,a)}})});