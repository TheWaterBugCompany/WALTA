<!DOCTYPE HTML>
<html>
	<head>
		<title>Testing walta.KeyView</title>
		<script type="text/javascript" src="../../dojo/dojo.js"></script>
		<script type="text/javascript">
			require(["dojo", "doh", "dojo/aspect", "walta/KeyView", "dojox/mobile/deviceTheme", "dojo/domReady!"], function(dojo, doh, aspect, KeyView ){
				doh.register("Instantiation", 
					function loadKey() {
						var deferred = new doh.Deferred();
						var key = new KeyView( { keyUrl: "../../../../walta-data/taxonomies/test" }, "keyTree");
    					
    					// when the key is loaded continue the test
    					aspect.after( key, "onKeyLoaded", function() {
    						
    							// Check that the basic key has been loaded
    							doh.assertEqual( key._key.name, "WALTA" );
    							deferred.callback(true);
    					});	
    					
    					// start up the widget
    					key.startup();
    					
    					return deferred;
					}
				);
				doh.run();
			});
		</script>
	</head>
	<body>
		<div id="keyTree"></div>
	</body>
</html>
